# Dev-breadcrumbs

Здесь будут заметки относительно технологий, с которым удалось вплотную или вскольз поработать.

## Базы данных

### debezium
позволяет настроить потоковую передачу данных из одной базы в другую или куда угодно еще.
Для передачи данных используется Kafka, debezium имеет коннкеторы к многим популярным базам данных (mongodb, postgres, mysql, ...).
С помощью него можно, например, настроить отправку и обновление индексов в поисковом движке (sphinx, elastic) или же отправлять
информацию об изменениях в аналитическую систему.

### Cassandra
**Особенности**
 - является, по сути, key-value хранилищем
 - **Модель данных**:
   - keySpace - база данных
   - columnFamily -  таблица
   - column - колонки
 - шардинг из коробки  
 - автоматическая перебалансировка в процессе работы и при добавлении новых нод  
 - высокая отказоустойчивость  
 - репликация данных асинхронная  
 - master-master, master-slave репликация  
 - нет транзакций  
 - любая нода кластера может выступать в роли точки доступа (координатора)  
 - [при вставке данных можно определить количество подтвердений записи (one, n, all, кворум)](https://www.dropbox.com/s/lsx3xutos7cz1p9/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%202018-10-25%2001.07.28.png?dl=0)  
 - те же механизмы можно использовать при извлечении данных  
 - шардирование по ключам можно сделать:  
   - по заданным ключам  
   - по случайным ключам  
 - периодически запускается процесс уплотнения, который объединяет таблицы на диске  
 - при удалении данных по ключу происходит запись метки об удалении.
   Иначе при дальнейшем считывании наличие записи на одном из узлов
   будет означать, что запись есть  
 - у маркеров об удалении есть время жизни, после чего они тоже должны удаляться  
 - есть операция repair, которая приводит базу в консистентное состояние
 - если вовремя не запустить repair и успеют удалиться метки об удалении,
   то появится масса zombie-меток  
 - периодически надо делать repair на кластере  
 - период удаления меток об удалении > период repair  
 - нужно избегать large partition-реплик  
 - нужно много мониторинга, чтобы уметь понять почему выросла скорость ответа координатора  

### Clickhouse
высокопроизводительная колоночная база данных. Предназначена, главным образом, для аналитики,
имеет ряд особенностей:
 - медленная вставка единичных записей
 - очень высокая скорость вставки большого количества записей, вплоть до миллионов
 - низкая скорость чтения единичных строк
 - огромная скрость чтения агрегирующих запросов на большое количество записей
 - после вставки, данные еще перемещаются на диске внутри партиции, а также уплотняются
 - в дефолтном движке нет операций обновление и удаление (для этого есть кастомные движки)
 - есть шардинг из коробки
